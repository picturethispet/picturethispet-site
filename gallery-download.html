<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Download Center | Picture This Pet</title>
  <meta name="description" content="Download your selected photos in high resolution.">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet" />

  <style>
    :root {
      --orange: #F47C2C;
      --gold: #FDB75E;
      --dark-brown: #4B2E1E;
      --available-green: #10b981;
      --booked-red: #ef4444;
      --soft-hold-yellow: #f59e0b;
      --gallery-purple: #8b5cf6;
      --gallery-blue: #3b82f6;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html {
      overflow-x: hidden;
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
      scroll-behavior: smooth;
    }
    
    html::-webkit-scrollbar {
      width: 8px;
    }
    
    html::-webkit-scrollbar-track {
      background: transparent;
    }
    
    html::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      color: white;
      background: none;
      overflow-x: hidden;
      min-height: 100vh;
    }

    @keyframes moveBackground {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes progressFill {
      from { width: 0%; }
      to { width: 100%; }
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }

    /* === HEADER STYLES === */
    header {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.01rem 1.5rem;
      background-image: url('assets/images/ani_bkgd_cool.png');
      background-size: 100% 100%;
      background-position: center;
      animation: moveBackground 30s ease-in-out infinite;
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      height: 110px;
    }
    
    .desktop-logo {
      height: 100px;
    }

    .logo-link {
      display: flex;
      align-items: center;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .logo-link:hover {
      opacity: 0.8;
      transform: scale(1.02);
    }
    
    .gallery-nav {
      display: flex;
      align-items: center;
      margin-left: auto;
      gap: 1rem;
    }

    .gallery-info {
      background: rgba(255, 255, 255, 0.1);
      padding: 0.8rem 1.5rem;
      border-radius: 25px;
      font-size: 0.9rem;
      font-weight: 600;
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .back-btn {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .back-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-1px);
    }
    
    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      color: white;
      font-size: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    /* === MAIN CONTENT === */
    main {
      margin-top: 110px;
      min-height: calc(100vh - 110px);
      background-image: url('assets/images/ani_bkgd_cool.png');
      background-size: 100% 100%;
      background-position: center;
      animation: moveBackground 30s ease-in-out infinite;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem 1rem;
    }

    /* === DOWNLOAD CONTAINER === */
    .download-container {
      max-width: 800px;
      width: 100%;
      animation: fadeInUp 0.8s ease-out;
    }

    .download-card {
      background-image: url('assets/images/ani_bkgd_cool.png');
      background-size: 100% 100%;
      background-position: center;
      animation: moveBackground 30s ease-in-out infinite;
      border-radius: 24px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      padding: 3rem;
      color: white;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
      transition: all 0.3s ease;
    }

    .download-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--available-green), #059669);
      color: white;
      padding: 0.8rem 2rem;
      border-radius: 25px;
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 2rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .download-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .download-subtitle {
      font-size: 1.2rem;
      line-height: 1.6;
      margin-bottom: 3rem;
      color: rgba(255, 255, 255, 0.9);
    }

    /* === PHOTO PREVIEW === */
    .photo-preview {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 1rem;
      margin-bottom: 3rem;
      max-height: 200px;
      overflow: hidden;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .preview-photo {
      aspect-ratio: 1;
      border-radius: 8px;
      object-fit: cover;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .preview-photo:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .preview-more {
      aspect-ratio: 1;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: rgba(255, 255, 255, 0.7);
      border: 2px dashed rgba(255, 255, 255, 0.3);
    }

    /* === DOWNLOAD OPTIONS === */
    .download-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .option-card {
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
    }

    .option-card:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .option-card.selected {
      background: rgba(16, 185, 129, 0.2);
      border-color: var(--available-green);
    }

    .option-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .option-icon {
      font-size: 2rem;
    }

    .option-title {
      font-size: 1.3rem;
      font-weight: 600;
      color: white;
    }

    .option-subtitle {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.7);
    }

    .option-details {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.95rem;
      line-height: 1.5;
    }

    .option-details ul {
      list-style: none;
      padding-left: 0;
      margin-top: 1rem;
    }

    .option-details li {
      margin-bottom: 0.5rem;
      padding-left: 1.5rem;
      position: relative;
    }

    .option-details li::before {
      content: "✓";
      position: absolute;
      left: 0;
      color: var(--available-green);
      font-weight: bold;
    }

    /* === DOWNLOAD PROGRESS === */
    .download-progress {
      display: none;
      margin-bottom: 2rem;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .progress-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: white;
    }

    .progress-percentage {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--available-green);
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(135deg, var(--available-green), #059669);
      border-radius: 6px;
      transition: width 0.3s ease;
      width: 0%;
    }

    .progress-details {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.8);
      text-align: center;
    }

    /* === BUTTONS === */
    .action-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .download-btn {
      background: linear-gradient(135deg, var(--available-green), #059669);
      color: white;
      border: none;
      padding: 1.2rem 3rem;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    }

    .download-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(16, 185, 129, 0.5);
    }

    .download-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .download-btn.processing {
      background: linear-gradient(135deg, var(--gallery-purple), var(--gallery-blue));
      animation: bounce 2s infinite;
    }

    .secondary-btn {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      padding: 1.2rem 3rem;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .secondary-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
    }

    /* === SUCCESS STATE === */
    .success-state {
      display: none;
      text-align: center;
      padding: 2rem;
    }

    .success-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      animation: bounce 1s ease-out;
    }

    .success-title {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--available-green);
    }

    .success-message {
      font-size: 1.1rem;
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.6;
      margin-bottom: 2rem;
    }

    .download-info {
      background: rgba(16, 185, 129, 0.2);
      border: 1px solid rgba(16, 185, 129, 0.5);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      text-align: left;
    }

    .download-info h4 {
      color: var(--available-green);
      margin-bottom: 1rem;
      font-weight: 600;
    }

    .download-info ul {
      list-style: none;
      padding: 0;
    }

    .download-info li {
      margin-bottom: 0.5rem;
      padding-left: 1.5rem;
      position: relative;
      color: rgba(255, 255, 255, 0.9);
    }

    .download-info li::before {
      content: "📁";
      position: absolute;
      left: 0;
    }

    /* === MOBILE RESPONSIVE === */
    @media (max-width: 768px) {
      header {
        height: 80px;
        padding: 0.5rem 1rem;
      }
      
      .desktop-logo { 
        height: 48px; 
      }
      
      .gallery-nav {
        display: none;
        flex-direction: column;
        background-image: url('assets/images/ani_bkgd_cool.png');
        background-size: 100% 100%;
        background-position: center;
        position: absolute;
        top: 80px;
        right: 0;
        width: 100%;
        text-align: right;
        padding: 1rem;
        z-index: 999;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(12px);
        gap: 1rem;
      }
      
      .gallery-nav.active {
        display: flex;
      }
      
      .mobile-menu-btn {
        display: block;
      }
      
      main {
        margin-top: 80px;
        padding: 1rem;
      }

      .download-card {
        padding: 2rem;
      }

      .download-title {
        font-size: 2rem;
      }

      .download-subtitle {
        font-size: 1rem;
      }

      .download-options {
        grid-template-columns: 1fr;
      }

      .action-buttons {
        flex-direction: column;
        align-items: center;
      }

      .download-btn,
      .secondary-btn {
        width: 100%;
        max-width: 300px;
      }

      .photo-preview {
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        padding: 1rem;
        max-height: 150px;
      }
    }
  </style>
</head>
<body>
  <header>
    <a href="/" class="logo-link" aria-label="PictureThisPet Home">
      <img src="assets/images/headerlogowarm.png" alt="PictureThisPet Logo" class="desktop-logo" />
    </a>
    <nav class="gallery-nav">
      <div class="gallery-info">Download Center</div>
      <a href="/gallery-home.html" class="back-btn">← Back to Gallery</a>
    </nav>
    <button class="mobile-menu-btn" aria-label="Toggle mobile menu" onclick="toggleMenu()">☰</button>
  </header>

  <main>
    <div class="download-container">
      <div class="download-card">
        <!-- Initial State -->
        <div id="downloadForm">
          <div class="download-badge">📥 Ready to Download</div>
          <h1 class="download-title">Download Your Photos</h1>
          <p class="download-subtitle" id="downloadSubtitle">
            You've selected 5 beautiful photos from Buffy & Max's session. 
            Choose your preferred download format below.
          </p>

          <!-- Photo Preview -->
          <div class="photo-preview" id="photoPreview">
            <img src="https://images.unsplash.com/photo-1601758228041-f3b2795255f1?w=120&h=120&fit=crop" class="preview-photo" alt="Selected photo">
            <img src="https://images.unsplash.com/photo-1583337130417-3346a1be7dee?w=120&h=120&fit=crop" class="preview-photo" alt="Selected photo">
            <img src="https://images.unsplash.com/photo-1587300003388-59208cc962cb?w=120&h=120&fit=crop" class="preview-photo" alt="Selected photo">
            <img src="https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=120&h=120&fit=crop" class="preview-photo" alt="Selected photo">
            <div class="preview-more">+1</div>
          </div>

          <!-- Download Options -->
          <div class="download-options">
            <div class="option-card selected" onclick="selectOption('high-res')" data-option="high-res">
              <div class="option-header">
                <div class="option-icon">🎯</div>
                <div>
                  <div class="option-title">High Resolution</div>
                  <div class="option-subtitle">Professional Quality</div>
                </div>
              </div>
              <div class="option-details">
                Perfect for printing and professional use.
                <ul>
                  <li>Full resolution images</li>
                  <li>No watermarks</li>
                  <li>Print-ready quality</li>
                  <li>ZIP file delivery</li>
                </ul>
              </div>
            </div>

            <div class="option-card" onclick="selectOption('web-res')" data-option="web-res">
              <div class="option-header">
                <div class="option-icon">💻</div>
                <div>
                  <div class="option-title">Web Resolution</div>
                  <div class="option-subtitle">Social & Digital Use</div>
                </div>
              </div>
              <div class="option-details">
                Optimized for social media and web use.
                <ul>
                  <li>1920px max width</li>
                  <li>Smaller file sizes</li>
                  <li>Quick download</li>
                  <li>Social media ready</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <button class="download-btn" id="startDownloadBtn" onclick="startDownload()">
              Start Download
            </button>
            <a href="/gallery-home.html" class="secondary-btn">
              Back to Gallery
            </a>
          </div>
        </div>

        <!-- Progress State -->
        <div class="download-progress" id="downloadProgress">
          <div class="progress-header">
            <div class="progress-title">Preparing Your Download...</div>
            <div class="progress-percentage" id="progressPercentage">0%</div>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="progress-details" id="progressDetails">
            Initializing download process...
          </div>
        </div>

        <!-- Success State -->
        <div class="success-state" id="successState">
          <div class="success-icon">🎉</div>
          <h2 class="success-title">Download Complete!</h2>
          <p class="success-message">
            Your photos have been successfully prepared and downloaded. 
            Check your Downloads folder for the ZIP file.
          </p>
          
          <div class="download-info">
            <h4>Download Details:</h4>
            <ul id="downloadDetails">
              <li>5 high-resolution photos</li>
              <li>Total file size: ~45 MB</li>
              <li>Format: ZIP archive</li>
              <li>Quality: Print-ready</li>
            </ul>
          </div>

          <div class="action-buttons">
            <a href="/gallery-home.html" class="download-btn">
              Back to Gallery
            </a>
            <button class="secondary-btn" onclick="downloadAgain()">
              Download Again
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Mobile menu toggle
    function toggleMenu() {
      const nav = document.querySelector('.gallery-nav');
      nav.classList.toggle('active');
    }

    // Download state
    let selectedOption = 'high-res';
    let selectedPhotos = [];

    // Load selected photos from gallery
    function loadSelectedPhotos() {
      const storedPhotos = localStorage.getItem('selectedPhotosForDownload');
      if (storedPhotos) {
        try {
          selectedPhotos = JSON.parse(storedPhotos);
        } catch (e) {
          console.error('Error parsing stored photos:', e);
          selectedPhotos = [];
        }
      }
      
      // If no photos selected, use demo data (for testing) or redirect
      if (!selectedPhotos || selectedPhotos.length === 0) {
        // For demo purposes, use fallback data
        // In production, you'd redirect: window.location.href = '/gallery-home.html';
        selectedPhotos = [
          { id: 1, title: 'Buffy Portrait', src: 'https://images.unsplash.com/photo-1601758228041-f3b2795255f1' },
          { id: 2, title: 'Max Action Shot', src: 'https://images.unsplash.com/photo-1583337130417-3346a1be7dee' },
          { id: 3, title: 'Duo Adventure', src: 'https://images.unsplash.com/photo-1587300003388-59208cc962cb' },
          { id: 4, title: 'Buffy Close-up', src: 'https://images.unsplash.com/photo-1518717758536-85ae29035b6d' },
          { id: 5, title: 'Max Smile', src: 'https://images.unsplash.com/photo-1552053831-71594a27632d' }
        ];
        console.log('Using demo data for download page');
      }
      
      updatePhotoPreview();
      updateSubtitle();
    }

    // Update photo preview grid
    function updatePhotoPreview() {
      const previewContainer = document.getElementById('photoPreview');
      const maxVisible = 4;
      
      previewContainer.innerHTML = '';
      
      // Show up to 4 photos
      selectedPhotos.slice(0, maxVisible).forEach(photo => {
        const img = document.createElement('img');
        img.src = photo.src + '?w=120&h=120&fit=crop';
        img.className = 'preview-photo';
        img.alt = photo.title;
        previewContainer.appendChild(img);
      });
      
      // Show "+X more" if there are additional photos
      if (selectedPhotos.length > maxVisible) {
        const moreDiv = document.createElement('div');
        moreDiv.className = 'preview-more';
        moreDiv.textContent = `+${selectedPhotos.length - maxVisible}`;
        previewContainer.appendChild(moreDiv);
      }
    }

    // Update subtitle with photo count
    function updateSubtitle() {
      const subtitle = document.getElementById('downloadSubtitle');
      subtitle.textContent = `You've selected ${selectedPhotos.length} beautiful photo${selectedPhotos.length === 1 ? '' : 's'} from Buffy & Max's session. Choose your preferred download format below.`;
    }

    // Select download option
    function selectOption(option) {
      selectedOption = option;
      
      // Update UI
      document.querySelectorAll('.option-card').forEach(card => {
        card.classList.remove('selected');
      });
      document.querySelector(`[data-option="${option}"]`).classList.add('selected');
    }

    // Start download process
    function startDownload() {
      // Hide form, show progress
      document.getElementById('downloadForm').style.display = 'none';
      document.getElementById('downloadProgress').style.display = 'block';
      
      // Simulate download progress
      simulateDownload();
    }

    // Simulate download progress
    function simulateDownload() {
      const progressFill = document.getElementById('progressFill');
      const progressPercentage = document.getElementById('progressPercentage');
      const progressDetails = document.getElementById('progressDetails');
      
      let progress = 0;
      const steps = [
        { percent: 10, message: 'Validating session permissions...' },
        { percent: 25, message: 'Removing watermarks...' },
        { percent: 45, message: 'Processing high-resolution images...' },
        { percent: 65, message: 'Optimizing file sizes...' },
        { percent: 80, message: 'Creating ZIP archive...' },
        { percent: 95, message: 'Finalizing download...' },
        { percent: 100, message: 'Download complete!' }
      ];
      
      let stepIndex = 0;
      
      const interval = setInterval(() => {
        if (stepIndex < steps.length) {
          const step = steps[stepIndex];
          progress = step.percent;
          
          progressFill.style.width = progress + '%';
          progressPercentage.textContent = progress + '%';
          progressDetails.textContent = step.message;
          
          stepIndex++;
        } else {
          clearInterval(interval);
          setTimeout(showSuccess, 500);
        }
      }, 800);
    }

    // Show success state
    function showSuccess() {
      document.getElementById('downloadProgress').style.display = 'none';
      document.getElementById('successState').style.display = 'block';
      
      // Update download details based on selected option
      const details = document.getElementById('downloadDetails');
      const optionText = selectedOption === 'high-res' ? 'high-resolution' : 'web-resolution';
      const sizeText = selectedOption === 'high-res' ? '~45 MB' : '~8 MB';
      
      details.innerHTML = `
        <li>${selectedPhotos.length} ${optionText} photo${selectedPhotos.length === 1 ? '' : 's'}</li>
        <li>Total file size: ${sizeText}</li>
        <li>Format: ZIP archive</li>
        <li>Quality: ${selectedOption === 'high-res' ? 'Print-ready' : 'Web-optimized'}</li>
      `;

      // Trigger actual download (simulated)
      triggerDownload();
      
      // Clear localStorage after successful download
      localStorage.removeItem('selectedPhotosForDownload');
    }

    // Trigger the actual download
    function triggerDownload() {
      // In a real implementation, this would generate and download the actual ZIP file
      // For demo purposes, we'll create a blob and trigger download
      
      const fileName = `BuffyMax_Session_${selectedOption === 'high-res' ? 'HighRes' : 'WebRes'}_${new Date().toISOString().split('T')[0]}.zip`;
      
      // Create a dummy file for demonstration
      const dummyContent = `# Photo Download - Buffy & Max Session\n\nDownload Date: ${new Date().toLocaleString()}\nResolution: ${selectedOption}\nPhotos Included: ${selectedPhotos.length}\n\nPhoto List:\n${selectedPhotos.map(photo => `- ${photo.title}`).join('\n')}\n\nThank you for choosing Picture This Pet!`;
      
      const blob = new Blob([dummyContent], { type: 'text/plain' });
      const url = window.URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
      
      console.log(`✅ Download triggered: ${fileName}`);
    }

    // Download again function
    function downloadAgain() {
      // Reset to initial state
      document.getElementById('successState').style.display = 'none';
      document.getElementById('downloadForm').style.display = 'block';
      
      // Reset progress
      document.getElementById('progressFill').style.width = '0%';
      document.getElementById('progressPercentage').textContent = '0%';
      document.getElementById('progressDetails').textContent = 'Initializing download process...';
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      // Load selected photos from gallery
      loadSelectedPhotos();
      
      // Log page load
      console.log('📥 Download Center loaded');
      console.log('Selected photos:', selectedPhotos);
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && document.getElementById('downloadForm').style.display !== 'none') {
        startDownload();
      }
      
      if (e.key === 'Escape') {
        window.location.href = '/gallery-home.html';
      }
    });
  </script>
</body>
</html>
