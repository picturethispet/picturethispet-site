<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Picture This Pet | Capture Timeless Memories</title>
  <meta name="description" content="Professional pet photography that captures timeless moments. Book your session today.">
  <meta name="robots" content="noarchive, noodp, noimageindex">
  <link rel="canonical" href="https://picturethispet.co/" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet" />

  <style>
    :root {
      --orange: #F47C2C;
      --gold: #FDB75E;
      --dark-brown: #4B2E1E;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html, body {
      overflow-x: hidden;
      overflow-y: auto; /* Allow vertical scrolling */
    }
    
    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
      color: white;
      background: none;
    }

    @keyframes moveBackground {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* === HEADER STYLES === */
    header, footer {
      background-image: url("assets/images/main_background_allsystem.png");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      animation: moveBackground 30s ease-in-out infinite;
      background-size: 100% 100%;
    }
    
    header {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.01rem 1.5rem;
      background-color: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(8px);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      height: 110px;
    }
    
    .desktop-logo {
      height: 100px;
    }

    .logo-link {
      display: flex;
      align-items: center;
      transition: opacity 0.3s ease;
    }

    .logo-link:hover {
      opacity: 0.8;
    }
    
    .site-nav {
      display: flex;
      align-items: center;
      margin-left: auto;
    }
    
    .site-nav a {
      color: white;
      margin-left: 1rem;
      text-decoration: none;
      font-weight: 600;
    }
    
    .book-btn {
      background-color: var(--dark-brown);
      color: white;
      padding: 0.6rem 1.2rem;
      border-radius: 999px;
      font-weight: bold;
      text-decoration: none;
      margin-left: 1rem;
    }
    
    .mobile-menu-btn {
      display: none;
    }

    /* === HERO SECTION === */
    .hero-section {
      margin-top: 100px;
      position: relative;
    }
    
    .hero-section img {
      width: 100%;
      height: auto;
      display: block;
    }
    
    .gradient-text {
      font-family: 'Playfair Display', serif;
      font-weight: 700;
      font-size: 3rem;
      position: absolute;
      top: 20px;
      right: 40px;
      background: url("assets/images/ani_bkgd_cool.png");
      background-size: 200%;
      background-position: center;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: right;
      max-width: 320px;
      pointer-events: none;
    }

    /* === SECTION SPLIT === */
    .section-split {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2rem 2rem 3rem;
      position: relative;
      background-image: url("assets/images/main_background_allsystem.png");
      background-size: 100% 100%;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      animation: moveBackground 30s ease-in-out infinite;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.25);
      z-index: 1;
    }
    
    .section-split::before {
      content: "";
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url("assets/images/main_background_allsystem.png");
      background-size: 100% 100%;
      background-position: center;
      background-repeat: no-repeat;
      z-index: -1;
      animation: moveBackground 30s ease-in-out infinite;
      opacity: 0.5;
    }
    
    .side-a, .side-b {
      flex: 1;
      padding: 2rem;
    }
    
    .side-a {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      text-align: right;
    }
    
    .side-a h1 {
      max-width: 420px;
      margin-left: auto;
      font-family: 'Inter', sans-serif;
      font-weight: 900;
      font-size: 3.8rem;
      line-height: 1.25;
      background: url("assets/images/ani_bkgd_cool.png");
      background-size: cover;
      background-position: center;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: left;
    }
    
    .side-b-inner {
      display: flex;
      flex-direction: column;
      text-align: left;
      max-width: 420px;
    }
    
    .side-b h2 {
      font-family: 'Playfair Display', serif;
      font-weight: 700;
      font-size: 2.3rem;
      line-height: 1.3;
      margin-bottom: 1rem;
    }
    
    .side-b p {
      font-family: 'Inter', sans-serif;
      font-size: 1.35rem;
      line-height: 1.75;
      max-width: 480px;
      margin: 0 auto;
    }

    /* === SESSION BUILDER SECTION === */
    section#session-builder-section {
      padding: 6rem 1rem;
      background: url('assets/images/main_background_allsystem.png');
      background-size: 100% 100%;
      animation: moveBackground 30s ease-in-out infinite;
      position: relative;
      overflow: hidden;
    }

    .session-builder-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .session-heading {
      font-family: 'Inter', sans-serif;
      font-weight: 900;
      font-size: 3.8rem;
      line-height: 1.25;
      background: url('assets/images/ani_bkgd_cool.png');
      background-size: cover;
      background-position: center;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 1rem;
    }

    .session-subtext {
      color: white;
      font-size: 1.2rem;
      font-family: 'SF Pro Display', sans-serif;
      max-width: 650px; /* Wider to prevent "type" on separate line */
      margin: 0 auto;
      text-align: center;
      opacity: 0.9;
      line-height: 1.6;
    }

    /* === SESSION CARDS === */
    .session-card-stack {
      max-width: 600px;
      margin: 0 auto;
      position: relative;
      height: auto; /* Allow natural height instead of fixed */
      z-index: 2;
      min-height: 500px; /* Minimum height but can grow */
    }

    .session-card {
      background-image: url('assets/images/ani_bkgd_cool.png');
      background-size: 100% 100%;
      background-position: center;
      height: 500px; /* Default height for most cards */
      width: 100%;
      max-width: 600px;
      animation: moveBackground 30s ease-in-out infinite;
      border-radius: 24px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      padding: 2rem;
      color: white;
      font-family: 'SF Pro Display', sans-serif;
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0;
      transform: scale(0.9);
      display: none;
      position: relative; /* Changed from absolute to relative for stack flow */
      overflow: hidden;
    }

    .session-card.agreement-card {
      height: 750px; /* Even taller for better spacing */
      padding: 2.5rem 2rem; /* More top/bottom padding for spacing */
    }

    .session-card.active {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      opacity: 1;
      transform: scale(1);
      position: relative; /* Keep relative when active */
    }

    .session-card.exiting {
      opacity: 0;
      transform: scale(0.8);
      position: absolute; /* Allows it to animate out without affecting layout */
      top: 0;
      left: 0;
      width: 100%;
    }

    .session-card-logo {
      display: block;
      max-width: 180px;
      margin: 0 auto 1.5rem;
      height: auto;
    }

    .session-card-logo[src=""], 
    .session-card-logo:not([src]) {
      display: none;
    }

    .session-card-body {
      text-align: center;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 100%;
      min-height: 0; /* Allows flex to shrink */
    }

    .session-card-body h2 {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      color: white;
    }

    .session-card-body h3 {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      color: white;
    }

    .session-card-body p {
      font-size: 1.1rem;
      line-height: 1.6;
      opacity: 0.9;
      margin-bottom: 1.5rem;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .agreement-text { /* Added for agreement cards */
        font-size: 1rem;
        line-height: 1.5;
        max-height: 300px; /* Or adjust as needed */
        overflow-y: auto;
        padding: 0 1rem;
        margin-bottom: 1.5rem;
        text-align: left;
        border: 1px solid rgba(255,255,255,0.2);
        border-radius: 8px;
        background: rgba(0,0,0,0.1);
    }

    .agreement-checkbox { /* Added for agreement cards */
        margin-top: 1rem;
        margin-bottom: 1.5rem;
    }
    .agreement-checkbox label {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
    }
    .agreement-checkbox input[type="checkbox"] {
        margin-right: 0.5rem;
        transform: scale(1.2);
    }

    .session-info-list {
      list-style: none;
      padding: 0;
      margin: 1.5rem 0;
      text-align: left;
      max-width: 320px;
      margin-left: auto;
      margin-right: auto;
    }

    .session-info-list li {
      font-size: 1.1rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
    }

    .session-info-list li:last-child {
      border-bottom: none;
    }

    .question-prompt {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 2rem;
      color: white;
    }

    .answer-options {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .answer-button {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      min-width: 140px;
    }

    .answer-button:hover {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
    }

    .session-card-footer {
      margin-top: auto; /* Pushes footer to bottom */
      padding-top: 1rem; /* Space above footer */
      display: flex;
      justify-content: center;
      gap: 1rem;
      width: 100%;
    }


    .session-card-footer button,
    .continue-btn,
    .primary-btn {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .session-card-footer button:hover,
    .continue-btn:hover,
    .primary-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
    }
    
    .continue-btn.disabled, /* Added for disabled state */
    .primary-btn.disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }


    .navigation-buttons {
      display: flex;
      gap: 1rem;
      margin-top: 2rem;
      justify-content: center;
      width: 100%;
    }

    .back-btn,
    .restart-btn {
      background: rgba(255, 255, 255, 0.05);
      color: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 0.75rem 1.5rem;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .back-btn:hover,
    .restart-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border-color: rgba(255, 255, 255, 0.3);
    }

    /* === SUMMARY STYLES === */
    .session-summary h3 {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 2rem;
      color: white;
    }

    .session-summary-list {
      list-style: none;
      padding: 0;
      margin: 2rem 0;
      text-align: left;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }

    .session-summary-list li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding: 1rem 0;
      font-size: 1.1rem;
    }

    .session-summary-list li:last-child {
      border-bottom: none;
    }

    .session-summary-list li.total {
      font-weight: bold;
      font-size: 1.3rem;
      border-top: 2px solid rgba(255, 255, 255, 0.3);
      margin-top: 1rem;
      padding-top: 1rem;
    }

    .session-summary-list .label {
      color: rgba(255, 255, 255, 0.8);
    }

    .session-summary-list .value {
      color: white;
      font-weight: 600;
    }

    /* === FOOTER === */
    footer {
      background-color: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(8px);
      box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
      padding: 2rem 1rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .payments img {
      height: 30px;
      margin: 0 1rem;
      filter: brightness(0) invert(1);
    }

    /* === RESPONSIVE DESIGN === */
    @media (max-width: 768px) {
      header {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        height: 80px;
        padding: 0.5rem 1rem;
      }
      
      .desktop-logo { 
        height: 48px; 
      }
      
      .site-nav {
        display: none; /* Initially hidden for toggle */
        flex-direction: column;
        background: rgba(0,0,0,0.9);
        position: absolute;
        top: 80px; /* Height of header */
        right: 0;
        width: 100%;
        text-align: right;
        padding: 1rem;
        z-index: 999;
      }
      
      .site-nav.active { /* Added for JS toggle */
         display: flex;
      }

      .site-nav a {
        display: block;
        margin: 0.5rem 0;
        font-size: 1.2rem;
      }
      
      .mobile-menu-btn {
        display: block;
        background: none;
        border: none;
        color: white;
        font-size: 2rem;
        cursor: pointer;
      }
      
      .hero-section {
        margin-top: 80px;
      }
      
      .section-split {
        flex-direction: column;
        text-align: center;
        padding: 1.5rem 1rem;
        gap: 0.5rem;
      }
      
      .side-a h1, .side-b h2, .side-b p {
        text-align: center;
      }

      .side-a h1 {
        font-size: 2.5rem;
      }

      .side-b h2 {
        font-size: 1.8rem;
      }

      .side-b p {
        font-size: 1.1rem;
      }

      /* Mobile Session Builder */
      section#session-builder-section {
        padding: 4rem 1rem;
      }

      .session-heading {
        font-size: 2.5rem;
      }

      .session-subtext {
        font-size: 1rem;
        padding: 0 1rem;
      }

      .session-card-stack {
        height: auto; /* Allow natural height on mobile */
        min-height: 400px;
      }

      .session-card {
        height: auto; /* Auto height for content */
        min-height: 450px; /* Slightly smaller for mobile */
        padding: 1.5rem;
      }

      .session-card.agreement-card {
        height: auto; /* Auto height for content */
        min-height: 600px; /* Taller for mobile agreement cards */
        padding: 1.5rem 1.2rem;
      }
      
      .agreement-text {
        font-size: 0.9rem;
        padding: 0.5rem; /* Adjust padding for mobile */
        max-height: 200px; /* Adjust max height for mobile */
      }


      .session-card-body h2 {
        font-size: 1.6rem; /* Smaller on mobile */
      }

      .agreement-text { /* CSS rule for agreement text scrolling */
        font-size: 0.9rem;
        padding: 1.2rem;
        max-height: 250px; /* Or your desired height */
        overflow-y: auto; /* Enables vertical scrollbar if content exceeds max-height */
        text-align: left;
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 5px;
        margin-bottom: 1rem; /* Space below text box */
      }

      .session-subtext {
        max-width: 90%; /* More responsive on mobile */
        font-size: 1.1rem;
      }

      .session-card-body h2,
      .session-card-body h3 {
        font-size: 1.8rem;
      }

      .question-prompt {
        font-size: 1.6rem;
      }

      .answer-options {
        flex-direction: column;
        align-items: center;
      }

      .answer-button {
        width: 100%;
        max-width: 280px;
      }

      .navigation-buttons {
        flex-direction: column;
        align-items: center;
      }

      .back-btn,
      .restart-btn {
        width: 100%;
        max-width: 200px;
      }
    }

    @media (min-width: 769px) {
      .mobile-menu-btn { 
        display: none !important; 
      }
      .site-nav {
          display: flex !important; /* Ensure desktop nav is always flex */
          position: static;
          flex-direction: row;
          background: none;
          width: auto;
          padding: 0;
      }
      .site-nav a {
          margin-left: 1rem; /* Restore desktop margin */
      }
      
      .side-a { 
        padding-left: 6rem; 
      }
      
      .side-b { 
        padding-right: 2rem; 
      }
    }
  </style>
  
  <script>
    window.onbeforeunload = function () {
      window.scrollTo(0, 0);
    };
    
    function toggleMenu() {
      const nav = document.querySelector('.site-nav');
      nav.classList.toggle('active'); // Toggle active class for display
    }
  </script>
</head>
<body>
  <header>
    <a href="#" class="logo-link"> <img src="assets/images/header_logo_cool_final.png" alt="PictureThisPet Logo" class="desktop-logo" />
    </a>
    <nav class="site-nav">
      <a href="#">Home</a>
      <a href="#">Locations</a>
      <a href="#">Pricing</a>
      <a href="#">Contact</a>
      <a href="#" class="book-btn">Book Now</a>
    </nav>
    <button class="mobile-menu-btn" onclick="toggleMenu()">‚ò∞</button>
  </header>
  
  <main>
    <section class="hero-section">
      <img src="assets/images/sec1_img_final.png" alt="Golden Retriever in Cheesman Park" />
      <div class="section-breaker-shadow"></div>
    </section>
    
    <section class="section-split">
      <div class="side-a">
        <h1>ONE DAY, THEY WON'T<br />BE THERE BY YOUR SIDE</h1>
      </div>
      <div class="side-b">
        <div class="side-b-inner">
          <h2>But these moments?<br />They'll last forever.</h2>
          <p>Photographs capture your pet's personality, their quirks, the joy they bring into your life. Years from now, you'll cherish those memories.</p>
        </div>
      </div>
    </section>

    <section id="session-builder-section">
      <div class="session-builder-header">
        <h2 class="session-heading">Let's Find Your Perfect Session</h2>
        <p class="session-subtext">We take a unique approach to help you discover the perfect session type<br />for you and your pet. Just answer a few quick questions to get started.</p>
      </div>

      <div class="session-card-stack" id="sessionCardStack">
        </div>
    </section>
  </main>

  <footer>
    <div class="payments">
      <img src="/api/placeholder/80/30" alt="Visa" />
      <img src="/api/placeholder/80/30" alt="Mastercard" />
      <img src="/api/placeholder/80/30" alt="PayPal" />
    </div>
    <p>&copy; 2024 PictureThisPet. All rights reserved. | v1.4.1</p>
  </footer>

  <script>
    // Session Builder Logic
    const sessionData = {
      session: '',
      park: '',
      petCount: '',
      peopleCount: ''
    };

    const questions = [
      { label: "What type of session?", name: "session", options: ["Mini", "Full"] },
      { label: "Which park location?", name: "park", options: ["Cheesman Park", "City Park"] },
      { label: "How many pets? (max 2)", name: "petCount", options: ["1", "2"] },
      { label: "How many people? (max 2)", name: "peopleCount", options: ["1", "2"] }
    ];

    let currentCard = 0; // Index of the currently visible card
    let currentQuestion = 0; // Index for the questions array

    // Load existing data from localStorage
    function loadSessionData() {
      const saved = localStorage.getItem("ptpSessionData");
      if (saved) {
        Object.assign(sessionData, JSON.parse(saved));
      }
    }

    // Save data to localStorage
    function saveSessionData() {
      localStorage.setItem("ptpSessionData", JSON.stringify(sessionData));
    }

    // Calculate total price
    function calculateTotal() {
      let total = 0;
      if (sessionData.session === "Mini") total += 50;
      if (sessionData.session === "Full") total += 100;
      if (sessionData.petCount === "2") total += 40;
      if (sessionData.peopleCount === "2") total += 20;
      return total;
    }

    // Create card element
    function createCard(content, isActive = false) {
      const card = document.createElement("div");
      card.className = `session-card${isActive ? ' active' : ''}`;
      card.innerHTML = content;
      return card;
    }

    // Show specific card with simple transition
    function showCard(index) {
      const cards = document.querySelectorAll('.session-card');
      const cardStack = document.getElementById('sessionCardStack');
      
      cards.forEach((card, i) => {
        if (i === index) {
          card.classList.remove('exiting'); // Ensure not exiting if it's the target
          card.classList.add('active');
        } else {
          card.classList.remove('active');
        }
      });
      currentCard = index;

      // Adjust stack height
      const activeCardElement = cards[index];
      if (activeCardElement && cardStack) {
          // cardStack.style.height = activeCardElement.offsetHeight + 'px';
      }
    }
    
    // Advance to next card with poof animation
    function advanceCard() {
      const cards = document.querySelectorAll('.session-card');
      const currentCardEl = cards[currentCard]; // Use currentCard index

      if (currentCardEl) {
        currentCardEl.classList.add('exiting');
        
        setTimeout(() => {
          currentCardEl.classList.remove('active', 'exiting');
          if (currentCard < cards.length - 1) {
            showCard(currentCard + 1);
          } else {
            console.log("End of cards.");
          }
        }, 300); // Match transition duration
      } else if (currentCard < cards.length - 1) {
        showCard(currentCard + 1);
      }
    }


    // Go back to previous card
    function goBack() {
        const cards = document.querySelectorAll('.session-card');
        const currentActiveCard = cards[currentCard];

        if (currentActiveCard) {
            currentActiveCard.classList.add('exiting'); // Animate out current
             setTimeout(() => {
                currentActiveCard.classList.remove('active', 'exiting');
                if (currentCard > 0) {
                    // Determine if backing out of question sequence or general cards
                    if (currentCard === 3 && currentQuestion > 0) { // If on question card (index 3) and not first question
                        currentQuestion--;
                        renderCurrentQuestion(); // Re-render previous question on the same card
                        showCard(3); // Stay on question card
                    } else if (currentCard === 4 && questions.length > 0) { // If on summary (card 4), go back to last question
                        currentQuestion = questions.length -1;
                        renderCurrentQuestion();
                        showCard(3); // Go to question card
                    }
                    else {
                         showCard(currentCard - 1); // General previous card
                    }
                }
            }, 300);
        } else if (currentCard > 0) { // Fallback if no current active card somehow
            showCard(currentCard - 1);
        }
    }


    // Restart session
    function restartSession() {
      if (confirm("Are you sure you want to start over? This will clear all your selections.")) {
        Object.keys(sessionData).forEach(key => sessionData[key] = '');
        localStorage.removeItem("ptpSessionData");
        currentCard = 0;
        currentQuestion = 0;
        initializeSessionBuilder(); // Re-render all cards from scratch
      }
    }
    
    // Handle question answer (called by renderCurrentQuestion's buttons)
    function handleQuestionAnswer(questionName, answer) {
        selectAnswer(questionName, answer);
    }

    // Select answer logic
    function selectAnswer(questionName, answer) {
      sessionData[questionName] = answer;
      saveSessionData();
      
      const currentCardEl = document.querySelector('.session-card.active');

      if (currentCardEl) {
        currentCardEl.classList.add('exiting');
      }

      setTimeout(() => {
        if (currentCardEl) {
            currentCardEl.classList.remove('active', 'exiting');
        }
        if (currentQuestion < questions.length - 1) {
          currentQuestion++;
          renderCurrentQuestion(); // Update content of question card (card 3)
          showCard(3); // Ensure question card (index 3) is shown
        } else {
          // All questions answered, move to summary
          renderSummary(); // Update content of summary card (card 4)
          showCard(4); // Show summary card (index 4)
        }
      }, 300); // Delay matches animation
    }


    // Render current question
    function renderCurrentQuestion() {
      const questionCardContainer = document.getElementById('questionCard'); // This is the body of card 3
      if (!questionCardContainer) return;
      
      const question = questions[currentQuestion];
      if (!question) return;

      let backButtonLogic = `goBack()`; // Default back logic
      // If it's the first question, 'Back' should go to card 2 (Full Session Info)
      if (currentCard === 3 && currentQuestion === 0) {
          backButtonLogic = `showCard(2); currentCard=2;`; // Explicitly go to card 2
      }


      questionCardContainer.innerHTML = `
        <div class="question-prompt">${question.label}</div>
        <div class="answer-options">
          ${question.options.map(option => 
            `<button class="answer-button" onclick="handleQuestionAnswer('${question.name}', '${option}')">
              ${option}
            </button>`
          ).join('')}
        </div>
        <div class="navigation-buttons">
          <button class="back-btn" onclick="${backButtonLogic}">üîô Back</button>
          <button class="restart-btn" onclick="restartSession()">üîÑ Start Over</button>
        </div>
      `;
    }

    // Render summary
    function renderSummary() {
      const summaryCardContainer = document.getElementById('summaryCard'); // This is the body of card 4
      const total = calculateTotal();
      
      if (summaryCardContainer) {
        summaryCardContainer.innerHTML = `
          <h3>Your Session Summary</h3>
          <ul class="session-summary-list">
            <li><span class="label">Session:</span> <span class="value">${sessionData.session || "‚Äî"}</span></li>
            <li><span class="label">Location:</span> <span class="value">${sessionData.park || "‚Äî"}</span></li>
            <li><span class="label">Pets:</span> <span class="value">${sessionData.petCount || "‚Äî"}</span></li>
            <li><span class="label">People:</span> <span class="value">${sessionData.peopleCount || "‚Äî"}</span></li>
            <li class="total"><span class="label">Total:</span> <span class="value">$${total}</span></li>
          </ul>
          <div class="session-card-footer">
            <button class="continue-btn" onclick="advanceCard()">Continue to Agreements ‚Üí</button>
          </div>
          <div class="navigation-buttons">
            <button class="back-btn" onclick="goBack()">üîô Back</button>
            <button class="restart-btn" onclick="restartSession()">üîÑ Start Over</button>
          </div>
        `;
      }
    }

    // ---- AGREEMENT FUNCTIONS ----
    function checkAgreement(agreementType) {
      let checkboxId, buttonId;

      if (agreementType === 'behavior') {
        checkboxId = 'behaviorAgreement';
        buttonId = 'behaviorContinue';
      } else if (agreementType === 'photography') {
        checkboxId = 'photographyAgreement';
        buttonId = 'photographyContinue';
      } else if (agreementType === 'cancellation') {
        checkboxId = 'cancellationAgreement';
        buttonId = 'cancellationContinue';
      } else {
        console.error('Unknown agreement type:', agreementType);
        return;
      }

      const checkbox = document.getElementById(checkboxId);
      const continueButton = document.getElementById(buttonId);

      if (checkbox && continueButton) {
        if (checkbox.checked) {
          continueButton.classList.remove('disabled');
          continueButton.disabled = false;
        } else {
          continueButton.classList.add('disabled');
          continueButton.disabled = true;
        }
      } else {
        console.error('Checkbox or button not found for agreement type:', agreementType, checkboxId, buttonId);
      }
    }

    function proceedToCalendar() {
      const cancellationCheckbox = document.getElementById('cancellationAgreement');
      if (cancellationCheckbox && !cancellationCheckbox.checked) {
        alert("Please read and agree to the Cancellation & Refund Policy to continue.");
        return;
      }
      alert("Thank you for agreeing to the policies! You will now be redirected to select a date and time. (Placeholder - Implement actual redirect)");
      // Example redirect:
      // window.location.href = '/select-date-page.html';
      console.log("Final session data before redirecting:", sessionData);
    }
    // ---- END AGREEMENT FUNCTIONS ----


    // Initialize all cards
    function initializeSessionBuilder() {
      const container = document.getElementById('sessionCardStack');
      container.innerHTML = ''; // Clear previous cards

      // Card 0 - Intro
      const card0 = createCard(`
        <img src="assets/images/final_sessionbuilder_qcard_logo_warm.png" alt="PictureThisPet Logo" class="session-card-logo" />
        <div class="session-card-body">
          <h2>Let's go over what's included</h2>
          <p>In just a few quick steps, we'll help you pick the perfect session, and show you what's included with each option.</p>
        </div>
        <div class="session-card-footer">
          <button onclick="advanceCard()">Start ‚Üí</button>
        </div>
      `, true); // Start with this card active

      // Card 1 - Mini Session Info
      const card1 = createCard(`
        <img src="assets/images/final_sessionbuilder_qcard_logo_warm.png" alt="PictureThisPet Logo" class="session-card-logo" />
        <div class="session-card-body">
          <h2>Mini Session</h2>
          <ul class="session-info-list">
            <li>‚úî Up to 60 minutes</li>
            <li>‚úî 5 edited photos</li>
            <li>‚úî 1 person + 1 pet included</li>
            <li>‚úî Access to downloads & print shop</li>
          </ul>
        </div>
        <div class="session-card-footer">
          <button onclick="advanceCard()">Next ‚Üí</button>
        </div>
      `);

      // Card 2 - Full Session Info
      const card2 = createCard(`
        <img src="assets/images/final_sessionbuilder_qcard_logo_warm.png" alt="PictureThisPet Logo" class="session-card-logo" />
        <div class="session-card-body">
          <h2>Full Session</h2>
          <ul class="session-info-list">
            <li>‚úî Up to 90 minutes</li>
            <li>‚úî 10 edited photos</li>
            <li>‚úî 1 person + 1 pet included</li>
            <li>‚úî Access to downloads & print shop</li>
          </ul>
        </div>
        <div class="session-card-footer">
          <button onclick="advanceCard()">Next ‚Üí</button> </div>
      `);

      // Card 3 - Questions (Container for questions)
      // The content for this card's body will be rendered by renderCurrentQuestion()
      const card3 = createCard(`<div class="session-card-body" id="questionCard"></div>`);
      
      // Card 4 - Summary (Container for summary)
      // The content for this card's body will be rendered by renderSummary()
      const card4 = createCard(`<div class="session-card-body" id="summaryCard"></div>`);

      // Card 5 - Behavior Policy Agreement
      const card5 = createCard(`
        <img src="assets/images/final_sessionbuilder_qcard_logo_warm.png" alt="PictureThisPet Logo" class="session-card-logo" />
        <div class="session-card-body">
          <h2>üêï Behavior Policy</h2>
          <div class="agreement-text">
            <p>All pets must be under control and well-behaved throughout the session. Owners are responsible for their pet's behavior at all times. Disruptive or aggressive behavior from pets or people may result in early termination of the session without refund. Sessions take place in public and private environments, so respectful behavior from all parties ‚Äî pets, owners, and humans alike ‚Äî is required to ensure a safe and fun experience for everyone involved.</p>
          </div>
          <div class="agreement-checkbox">
            <label>
              <input type="checkbox" id="behaviorAgreement" onchange="checkAgreement('behavior')">
              <span>I acknowledge and agree to the Behavior Policy</span>
            </label>
          </div>
        </div>
        <div class="session-card-footer">
          <button id="behaviorContinue" class="continue-btn disabled" onclick="advanceCard()">Agree & Continue ‚Üí</button>
        </div>
      `);
      card5.classList.add('agreement-card');

      // Card 6 - Photography Agreement
      const card6 = createCard(`
        <img src="assets/images/final_sessionbuilder_qcard_logo_warm.png" alt="PictureThisPet Logo" class="session-card-logo" />
        <div class="session-card-body">
          <h2>üì∏ Photography Service Agreement</h2>
          <div class="agreement-text">
            <p>By participating in this photo session, you agree that all photographs taken by PictureThisPet are the intellectual property of the photographer. You are purchasing high-resolution digital files for personal use, but the photographer retains full ownership and the right to use images for marketing, portfolio, and promotional purposes. You may not alter, edit, or sell the images without written permission. You are granted a perpetual license to share and print the images for personal use, but PictureThisPet reserves all commercial rights.</p>
          </div>
          <div class="agreement-checkbox">
            <label>
              <input type="checkbox" id="photographyAgreement" onchange="checkAgreement('photography')">
              <span>I acknowledge and agree to the Photography Service Agreement</span>
            </label>
          </div>
        </div>
        <div class="session-card-footer">
          <button id="photographyContinue" class="continue-btn disabled" onclick="advanceCard()">Agree & Continue ‚Üí</button>
        </div>
      `);
      card6.classList.add('agreement-card');

      // Card 7 - Cancellation Policy Agreement
      const card7 = createCard(`
        <img src="assets/images/final_sessionbuilder_qcard_logo_warm.png" alt="PictureThisPet Logo" class="session-card-logo" />
        <div class="session-card-body">
          <h2>üìÖ Cancellation & Refund Policy</h2>
          <div class="agreement-text">
            <p>All session payments are non-refundable. However, sessions may be rescheduled with at least 48 hours' notice. In cases of severe weather or emergencies, we will work with you to find a new session date. Missed appointments or cancellations with less than 48 hours' notice are not eligible for rescheduling or refund. Your session is not guaranteed until full payment is received.</p>
          </div>
          <div class="agreement-checkbox">
            <label>
              <input type="checkbox" id="cancellationAgreement" onchange="checkAgreement('cancellation')">
              <span>I acknowledge and agree to the Cancellation & Refund Policy</span>
            </label>
          </div>
        </div>
        <div class="session-card-footer">
          <button id="cancellationContinue" class="continue-btn disabled" onclick="proceedToCalendar()">Agree & Continue to Date Selection ‚Üí</button>
        </div>
      `);
      card7.classList.add('agreement-card');

      // Add all cards to container
      container.appendChild(card0);
      container.appendChild(card1);
      container.appendChild(card2);
      container.appendChild(card3); // Question card placeholder
      container.appendChild(card4); // Summary card placeholder
      container.appendChild(card5);
      container.appendChild(card6);
      container.appendChild(card7);

      // Initial setup for first question if needed, or rely on advanceCard logic
      // When card2's "Next" is clicked, it advances. If currentCard becomes 3 (question card index),
      // then renderCurrentQuestion should be called.
      // Let's refine advanceCard slightly or ensure the first question is ready
      // if the flow lands on card 3.

      // If advancing from card2 to card3, render the first question
      // This logic is now handled within selectAnswer for advancing questions
      // and the initial "Next" from card 2 will call advanceCard().
      // When showCard(3) is hit after card2's "Next", we need to ensure first question is rendered.
      // One way is to check in advanceCard or showCard:
      if (currentCard === 0) { // Starting fresh
         showCard(0); // Make sure first card is active
      } else {
         showCard(currentCard); // Restore if re-initializing an existing state
      }
      
      // If a session was previously started and questions were answered,
      // and user reloads, we need to jump to the correct question or summary.
      // For simplicity now, restart begins fresh. A more advanced resume would
      // check localStorage and set currentQuestion and currentCard accordingly.
      if (currentCard === 3) { // If re-initializing and we should be on a question
          renderCurrentQuestion();
      } else if (currentCard === 4) { // If re-initializing and we should be on summary
          renderSummary();
      }


      // Explicitly disable agreement buttons initially after they are in the DOM
      ['behaviorContinue', 'photographyContinue', 'cancellationContinue'].forEach(buttonId => {
        const button = document.getElementById(buttonId);
        if (button) {
            button.disabled = true;
            // The class 'disabled' should already be on the button from the template
        }
      });
    }
    
    // DOMContentLoaded to ensure HTML is loaded before scripts run
    document.addEventListener('DOMContentLoaded', () => {
      loadSessionData();
      initializeSessionBuilder();
    });

  </script>
</body>
</html>
